<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LibOPCL: /Exemplos/Gemm/Arquivo/Sgemm/main.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LibOPCL
   </div>
   <div id="projectbrief">Biblioteca Portável para aplicações paralelas baseadas em OpenCL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Gerado por Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Busca');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Busca');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_2_exemplos_2_gemm_2_arquivo_2_sgemm_2main_8c-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/Exemplos/Gemm/Arquivo/Sgemm/main.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Exemplo de multiplicação de matrizes utilizando a libOPCL</p>
<div class="fragment"><div class="line"><span class="preprocessor">#pragma OPENCL EXTENSION cl_khr_fp64 : enable // Usar variáveis do tipo Double</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;ctype.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;ctype.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libopcl_8h.html">libopcl.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;omp.h&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// includes do OpenCL</span></div><div class="line"><span class="preprocessor">#include &lt;CL/cl.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define MAX_SOURCE_SIZE (0x100000)</span></div><div class="line"><span class="comment">//Tamanho do work-Group</span></div><div class="line"><span class="preprocessor">#define BSIZE 32</span></div><div class="line"></div><div class="line"><span class="comment">//Função para multiplicação de matrizes na CPU</span></div><div class="line"><span class="keywordtype">void</span> gemm_CPU(<span class="keywordtype">float</span> *a, <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span> *c, <span class="keywordtype">int</span> size, <span class="keywordtype">float</span> alfa, <span class="keywordtype">float</span> beta);</div><div class="line"><span class="comment">//Função para multiplicação de matrizes usando OpenCL</span></div><div class="line"><span class="keywordtype">void</span> gemm_OpenCL(<span class="keywordtype">float</span> *a, <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span> *c, <span class="keywordtype">int</span> size, <span class="keywordtype">int</span> t, <span class="keywordtype">float</span> alfa, <span class="keywordtype">float</span> beta);</div><div class="line"><span class="comment">//Função para comparação das matrizes geradas</span></div><div class="line"><span class="keywordtype">float</span> comparaMatrizes(<span class="keywordtype">float</span>* a, <span class="keywordtype">float</span>* b, <span class="keywordtype">int</span> size);</div><div class="line"><span class="keywordtype">void</span> printMatrix(<span class="keywordtype">float</span> *a, <span class="keywordtype">int</span> size);</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div><div class="line">{</div><div class="line"></div><div class="line">    <span class="comment">// Dados do Host</span></div><div class="line">    <span class="keywordtype">float</span> *A = NULL;  <span class="comment">// Array de entrada</span></div><div class="line">    <span class="keywordtype">float</span> *B = NULL;  <span class="comment">// Array de entrada</span></div><div class="line">    <span class="keywordtype">float</span> *C_host = NULL;  <span class="comment">// Array de saída</span></div><div class="line">    <span class="keywordtype">float</span> *C_device = NULL;  <span class="comment">// Array de saída</span></div><div class="line"></div><div class="line">    <span class="keywordtype">float</span> start, stop, t_s, t_p;</div><div class="line">    <span class="keywordtype">float</span> error;</div><div class="line"></div><div class="line">    <span class="keywordtype">float</span> alfa = 0.3, beta = 0.4;</div><div class="line">    <span class="comment">// Tamanho da Matriz(square matrix)</span></div><div class="line">    <span class="keywordtype">int</span> mSize = 1024;</div><div class="line">    <span class="keywordflow">if</span>(argc &gt;= 2)<span class="comment">//Receber tamanho da matriz por linha de comando, caso não receber nada o tamanho padrão é 1024x1024</span></div><div class="line">        mSize = atoi(argv[1]);</div><div class="line"></div><div class="line">    <span class="comment">// Elementos em cada array</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> elements = mSize*mSize;</div><div class="line"></div><div class="line">    <span class="comment">// Calcula o tamanho dos dados</span></div><div class="line">    <span class="keywordtype">size_t</span> datasize = <span class="keyword">sizeof</span>(float)*elements;</div><div class="line"></div><div class="line">    <span class="comment">//Aloca espaço para os dados de Entrada/Saída</span></div><div class="line">    A = (<span class="keywordtype">float</span>*)malloc(datasize);</div><div class="line">    B = (<span class="keywordtype">float</span>*)malloc(datasize);</div><div class="line">    C_host = (<span class="keywordtype">float</span>*)malloc(datasize);</div><div class="line">    C_device = (<span class="keywordtype">float</span>*)malloc(datasize);</div><div class="line"></div><div class="line">    <span class="comment">// Incializa os dados de entrada</span></div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; elements; i++) {</div><div class="line">        A[i] = 1.0;</div><div class="line">        B[i] = 2.0;</div><div class="line">        C_host[i] = 3.0;</div><div class="line">        C_device[i] = 3.0;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">//Execução do código Serial</span></div><div class="line">    start = omp_get_wtime();</div><div class="line">    gemm_CPU(A,B,C_host,mSize, alfa, beta);</div><div class="line">    stop = omp_get_wtime();</div><div class="line">    t_s = stop - start;</div><div class="line">    printf(<span class="stringliteral">&quot;Result Ok! time - %f\n&quot;</span>, t_s);</div><div class="line"></div><div class="line">    <span class="comment">//Execução do código Paralelo</span></div><div class="line">    start = omp_get_wtime();</div><div class="line">    gemm_OpenCL(A, B, C_device, mSize, 0,  alfa,  beta);</div><div class="line"></div><div class="line">    stop = omp_get_wtime();</div><div class="line">    t_p = stop - start;</div><div class="line"></div><div class="line">    <span class="comment">//Comparação dos dados e de tempo dos dois códigos</span></div><div class="line">    error = comparaMatrizes(C_host, C_device, mSize);</div><div class="line">    printf(<span class="stringliteral">&quot;Error - %f\n&quot;</span>, error);</div><div class="line">    printf(<span class="stringliteral">&quot;Result Ok! time - %f\n&quot;</span>, t_p);</div><div class="line">    printf(<span class="stringliteral">&quot;Result Ok! speedup - %f\n&quot;</span>, t_s/t_p);</div><div class="line"></div><div class="line">    <span class="comment">// Libera os recursos do Host</span></div><div class="line">    free(A);</div><div class="line">    free(B);</div><div class="line">    free(C_host);</div><div class="line">    free(C_device);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> gemm_CPU(<span class="keywordtype">float</span> *a, <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span> *c, <span class="keywordtype">int</span> size, <span class="keywordtype">float</span> alfa, <span class="keywordtype">float</span> beta)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> i, j, k;</div><div class="line">    <span class="keywordtype">float</span> cValue;</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span>(i=0; i&lt;size; i++)</div><div class="line">        <span class="keywordflow">for</span>(j=0; j&lt;size; j++){</div><div class="line">            cValue = c[i*size+j];</div><div class="line">            <span class="keywordflow">for</span>(k=0; k&lt;size; k++)</div><div class="line">                cValue += a[i*size+k]*b[k*size+j];</div><div class="line">            c[i*size+j] = alfa* cValue + beta*c[i*size+j];</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span> gemm_OpenCL(<span class="keywordtype">float</span> *a, <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span> *c, <span class="keywordtype">int</span> size, <span class="keywordtype">int</span> t, <span class="keywordtype">float</span> alfa, <span class="keywordtype">float</span> beta)</div><div class="line">{</div><div class="line">    <span class="comment">// Elementos em cada array</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> elements = size*size;</div><div class="line">    <span class="keywordtype">int</span> error = 0;</div><div class="line">    <span class="comment">// Calcula o tamanho dos elementos</span></div><div class="line">    <span class="keywordtype">size_t</span> datasize = <span class="keyword">sizeof</span>(float)*elements;</div><div class="line"></div><div class="line">    <span class="comment">// Usado para checar a saída do OpenCL</span></div><div class="line">    cl_int status;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//Leitura do arquivo onde está o kernel</span></div><div class="line">    FILE *fp;</div><div class="line">    <span class="keywordtype">char</span> *source_str;</div><div class="line">    <span class="keywordtype">size_t</span> source_size;</div><div class="line"></div><div class="line">    <span class="comment">//Carregando o arquivo com o Kernel</span></div><div class="line">    fp = fopen(<span class="stringliteral">&quot;dgemm-kernelPrivate.cl&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line">    <span class="keywordflow">if</span> (!fp) {</div><div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Failed to load kernel.\n&quot;</span>);</div><div class="line">        exit(1);</div><div class="line">    }</div><div class="line"></div><div class="line">    fseek(fp, 0, SEEK_END);<span class="comment">//Envia o cabeçote de leitura para o fim do arquivo.</span></div><div class="line">    <span class="keywordtype">long</span> fSize = ftell(fp);<span class="comment">//Retorna o tamanho do arquivo em bytes.</span></div><div class="line">    rewind(fp);<span class="comment">//Retorna a leitura para o inicio do arquivo.</span></div><div class="line"></div><div class="line">    source_str = (<span class="keywordtype">char</span>*)malloc((fSize+1)*<span class="keyword">sizeof</span>(char));<span class="comment">// Cria uma string com o tamanho do arquivo</span></div><div class="line">    source_size = fread( source_str, 1, (fSize+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), fp);<span class="comment">//Copia o conteúdo do kernel para a variável pré alocada</span></div><div class="line">    source_str[fSize] = <span class="charliteral">&#39;\0&#39;</span>;<span class="comment">//Marca o fim do arquivo.</span></div><div class="line">    fclose( fp );<span class="comment">//Fecha o arquivo.</span></div><div class="line"></div><div class="line">    <span class="comment">//printf(&quot;%F\n&quot;, c[0]);</span></div><div class="line"></div><div class="line">    <span class="comment">//----------------------------------------------------------------------------------------------------------</span></div><div class="line">    <span class="comment">// STEP 1: Descobrir e inicializar as plataformas e Devices, e criar contexto e Fila de Comando</span></div><div class="line">    <span class="comment">//----------------------------------------------------------------------------------------------------------</span></div><div class="line"></div><div class="line">    <a name="a0"></a><a class="code" href="libopcl_8h.html#ade7c32a3125e006727c4f4d04b450e4a">lopcl_Init</a>(<a name="a1"></a><a class="code" href="libopcl_8h.html#acd1877ff219ae50f2b395e14dbc71260">lopcl_POCL</a>, <a name="a2"></a><a class="code" href="libopcl_8h.html#a41fa98cabedaf81a3260a9c5c118b4be">lopcl_DEVICE_CPU</a>);</div><div class="line"></div><div class="line">    <span class="comment">//----------------------------------------------------------------------------------------------------------</span></div><div class="line">    <span class="comment">// STEP 2: Criar buffers do device e Escrever os dados do host para os lopcl_DEVICES de buffers</span></div><div class="line">    <span class="comment">//----------------------------------------------------- -----------------------------------------------------</span></div><div class="line"></div><div class="line"></div><div class="line">    cl_mem bufferA;  <span class="comment">// Array de entrada do device</span></div><div class="line">    cl_mem bufferB;  <span class="comment">// Array de entrada do device</span></div><div class="line">    cl_mem bufferC;  <span class="comment">// Array de saída do device</span></div><div class="line"></div><div class="line">    <span class="comment">// Use lopcl_CreateBuffer() para criar o objeto (d_A)</span></div><div class="line">    <span class="comment">// Isso contêm os dados do Array A do Host.</span></div><div class="line">    bufferA = <a name="a3"></a><a class="code" href="libopcl_8h.html#a83663158bec1bd08df09e58e6a9d33b1">lopcl_CreateBuffer</a>(datasize, CL_MEM_READ_ONLY, CL_FALSE, a);</div><div class="line"></div><div class="line">    <span class="comment">// Use lopcl_CreateBuffer() para criar o objeto (d_B)</span></div><div class="line">    <span class="comment">// Isso contêm os dados do Array B do Host.</span></div><div class="line">    bufferB = <a class="code" href="libopcl_8h.html#a83663158bec1bd08df09e58e6a9d33b1">lopcl_CreateBuffer</a>(datasize, CL_MEM_READ_ONLY, CL_FALSE, b);</div><div class="line"></div><div class="line">    <span class="comment">// Use lopcl_CreateBuffer() para criar o objeto (d_B)</span></div><div class="line">    <span class="comment">// com espaço suficiente para &quot;segurar&quot; os dados de saída.</span></div><div class="line">    bufferC = <a class="code" href="libopcl_8h.html#a83663158bec1bd08df09e58e6a9d33b1">lopcl_CreateBuffer</a>(datasize, CL_MEM_READ_WRITE, CL_FALSE, c);</div><div class="line"></div><div class="line">    <span class="comment">//---------------------------------------------------------------</span></div><div class="line">    <span class="comment">// STEP 3: Cria e compila o programa, e cria o kernel</span></div><div class="line">    <span class="comment">//----------------------------------------------------- ---------</span></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>(t==0)</div><div class="line">        <a name="a4"></a><a class="code" href="libopcl_8h.html#aa6b85c3609a9b0310f33f1929a1040ab">lopcl_CreateProgram</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>**)&amp;source_str, <span class="stringliteral">&quot;dgemm&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//-----------------------------------------------------</span></div><div class="line">    <span class="comment">// STEP 4: Define os argumentos do kernel</span></div><div class="line">    <span class="comment">//-----------------------------------------------------</span></div><div class="line"></div><div class="line">    <span class="comment">// Associa os buffers de entrada e saida ao kernel</span></div><div class="line">    <span class="comment">// usando lopcl_SetKernelArg()</span></div><div class="line"></div><div class="line">    <a name="a5"></a><a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(0, <span class="keyword">sizeof</span>( <span class="keywordtype">int</span>), &amp;size);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(1, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), &amp;size);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(2, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), &amp;size);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(3, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), &amp;alfa);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(4, <span class="keyword">sizeof</span>(cl_mem), &amp;bufferA);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(5, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), &amp;size);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(6, <span class="keyword">sizeof</span>(cl_mem), &amp;bufferB);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(7, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), &amp;size);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(8, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), &amp;beta);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(9, <span class="keyword">sizeof</span>(cl_mem), &amp;bufferC);</div><div class="line"></div><div class="line">    <a class="code" href="libopcl_8h.html#affccb59435b5513c8729a76a78d8ed30">lopcl_SetKernelArg</a>(10, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), &amp;size);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//--------------------------------------------------------------</span></div><div class="line">    <span class="comment">// STEP 5: Configurar a estrutura dos work itens e work groups</span></div><div class="line">    <span class="comment">//----------------------------------------------------- --------</span></div><div class="line"></div><div class="line">    <span class="keywordtype">size_t</span> globalWorkSize[2];</div><div class="line">    <span class="comment">// Esses são os elementos de work-items</span></div><div class="line">    globalWorkSize[0] = size/32;</div><div class="line">    globalWorkSize[1] = size/32;</div><div class="line"></div><div class="line">    <span class="keywordtype">size_t</span> localWorkSize[2];</div><div class="line"></div><div class="line">    localWorkSize[0] = BSIZE;</div><div class="line">    localWorkSize[1] = BSIZE;</div><div class="line"></div><div class="line">    <span class="comment">//-----------------------------------------------------</span></div><div class="line">    <span class="comment">// STEP 6: Empilha o Kernel para execução e Ler a saida do buffer de saída e salva no host</span></div><div class="line">    <span class="comment">//-----------------------------------------------------</span></div><div class="line"></div><div class="line">    <span class="comment">// Execute the kernel by using</span></div><div class="line">    <span class="comment">// clEnqueueNDRangeKernel().</span></div><div class="line">    <span class="comment">// &#39;globalWorkSize&#39; is the 1D dimension of the</span></div><div class="line">    <span class="comment">// work-items</span></div><div class="line">    </div><div class="line">    <a name="a6"></a><a class="code" href="libopcl_8h.html#a7407b4cea7094af350cfba6f58eb7c9c">lopcl_clEnqueueNDRangeKernel</a>(2, NULL, globalWorkSize, localWorkSize, bufferC, CL_TRUE, datasize, c);</div><div class="line"></div><div class="line">    <span class="comment">//-----------------------------------------------------</span></div><div class="line">    <span class="comment">// STEP 8: libera os recursos</span></div><div class="line">    <span class="comment">//-----------------------------------------------------</span></div><div class="line"></div><div class="line">    <span class="comment">//Free OpenCL resources</span></div><div class="line">    clReleaseKernel(<a name="a7"></a><a class="code" href="libopcl_8h.html#a79b979fb204a8c19d91ded3ea3666494">lopcl_KERNEL</a> );</div><div class="line">    clReleaseProgram(<a name="a8"></a><a class="code" href="libopcl_8h.html#a8a09a35e78c242e7e47a12cb469f6c03">lopcl_PROGRAM</a>);</div><div class="line">    clReleaseCommandQueue(<a name="a9"></a><a class="code" href="libopcl_8h.html#af57a50f399ecbe80bd418b9c482f549c">lopcl_CMDQUEUE</a>);</div><div class="line">    clReleaseContext(<a name="a10"></a><a class="code" href="libopcl_8h.html#ae02a0c6bb72304251b9dc9968edb29f3">lopcl_CONTEXT</a>);</div><div class="line">    clReleaseMemObject(bufferA);</div><div class="line">    clReleaseMemObject(bufferB);</div><div class="line">    clReleaseMemObject(bufferC);</div><div class="line">    <a name="a11"></a><a class="code" href="libopcl_8h.html#a7a201b693e4b7aff37d09e850a3462d6">lopcl_Finalize</a>();</div><div class="line">    free(source_str);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">float</span> comparaMatrizes(<span class="keywordtype">float</span>* a, <span class="keywordtype">float</span>* b, <span class="keywordtype">int</span> size)</div><div class="line">{</div><div class="line">    <span class="keywordtype">float</span> max = 0;</div><div class="line">    <span class="keywordtype">int</span> i, tSize = size*size;</div><div class="line">    <span class="keywordflow">for</span>(i=0; i&lt;tSize; i++)</div><div class="line">        <span class="keywordflow">if</span>(max &lt; fabs(a[i] - b[i]))</div><div class="line">            max =  fabs(a[i] - b[i]);</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> max;</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> printMatrix(<span class="keywordtype">float</span> *a, <span class="keywordtype">int</span> size)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> i,j;</div><div class="line">    <span class="keywordflow">for</span>(i=0;i&lt;size;i++){</div><div class="line">        <span class="keywordflow">for</span>(j=0; j&lt;size; j++)</div><div class="line">            printf(<span class="stringliteral">&quot;%f &quot;</span>, a[i*size +j]);</div><div class="line">        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Gerado por
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
